{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[95],{692:function(e,a,s){\"use strict\";s.r(a);var n=s(0),r=Object(n.a)({},(function(){var e=this,a=e.$createElement,s=e._self._c||a;return s(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[s(\"h3\",{attrs:{id:\"与spring集成\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#与spring集成\"}},[e._v(\"#\")]),e._v(\" 与Spring集成\")]),e._v(\" \"),s(\"ul\",[s(\"li\",[e._v(\"Shiro的组件都是JavaBean/POJO式的组件，所有非常容易使用Spring进行组件管理，可以非常方便的从ini配置迁移到pring进行管理，且支持JavaEE应用和Web应用的集成。\")]),e._v(\" \"),s(\"li\",[e._v(\"需导入shiro-spring及spring-context相关依赖\")]),e._v(\" \"),s(\"li\",[e._v(\"spring-beans.xml配置文件提供了基础组件如DataSource、DAO、Service组件的配置\")])]),e._v(\" \"),s(\"h3\",{attrs:{id:\"javase应用\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#javase应用\"}},[e._v(\"#\")]),e._v(\" JavaSE应用\")]),e._v(\" \"),s(\"p\",[s(\"strong\",[e._v(\"spring-shiro.xml提供了普通JavaSE独立应用的spring配置：\")])]),e._v(\" \"),s(\"div\",{staticClass:\"language- line-numbers-mode\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v('\\x3c!-- 缓存管理器 使用Ehcache实现 --\\x3e\\n<bean id=\"cacheManager\" class=\"org.apache.shiro.cache.ehcache.EhCacheManager\">\\n    <property name=\"cacheManagerConfigFile\" value=\"classpath:ehcache.xml\"/>\\n</bean>\\n\\x3c!-- 凭证匹配器 --\\x3e\\n<bean id=\"credentialsMatcher\" class=\"com.github.zhangkaitao.shiro.chapter12.credentials\\n        .RetryLimitHashedCredentialsMatcher\">\\n    <constructor-arg ref=\"cacheManager\"/>\\n    <property name=\"hashAlgorithmName\" value=\"md5\"/>\\n    <property name=\"hashIterations\" value=\"2\"/>\\n    <property name=\"storedCredentialsHexEncoded\" value=\"true\"/>\\n</bean>\\n\\x3c!-- Realm实现 --\\x3e\\n<bean id=\"userRealm\" class=\"com.github.zhangkaitao.shiro.chapter12.realm.UserRealm\">\\n    <property name=\"userService\" ref=\"userService\"/>\\n    <property name=\"credentialsMatcher\" ref=\"credentialsMatcher\"/>\\n    <property name=\"cachingEnabled\" value=\"true\"/>\\n    <property name=\"authenticationCachingEnabled\" value=\"true\"/>\\n    <property name=\"authenticationCacheName\" value=\"authenticationCache\"/>\\n    <property name=\"authorizationCachingEnabled\" value=\"true\"/>\\n    <property name=\"authorizationCacheName\" value=\"authorizationCache\"/>\\n</bean>\\n\\x3c!-- 会话ID生成器 --\\x3e\\n<bean id=\"sessionIdGenerator\" \\nclass=\"org.apache.shiro.session.mgt.eis.JavaUuidSessionIdGenerator\"/>\\n\\x3c!-- 会话DAO --\\x3e\\n<bean id=\"sessionDAO\" \\n    class=\"org.apache.shiro.session.mgt.eis.EnterpriseCacheSessionDAO\">\\n    <property name=\"activeSessionsCacheName\" value=\"shiro-activeSessionCache\"/>\\n    <property name=\"sessionIdGenerator\" ref=\"sessionIdGenerator\"/>\\n</bean>\\n\\x3c!-- 会话验证调度器 --\\x3e\\n<bean id=\"sessionValidationScheduler\" class=\"org.apache.shiro.session.mgt.quartz\\n        .QuartzSessionValidationScheduler\">\\n    <property name=\"sessionValidationInterval\" value=\"1800000\"/>\\n    <property name=\"sessionManager\" ref=\"sessionManager\"/>\\n</bean>\\n\\x3c!-- 会话管理器 --\\x3e\\n<bean id=\"sessionManager\" class=\"org.apache.shiro.session.mgt.DefaultSessionManager\">\\n    <property name=\"globalSessionTimeout\" value=\"1800000\"/>\\n    <property name=\"deleteInvalidSessions\" value=\"true\"/>\\n    <property name=\"sessionValidationSchedulerEnabled\" value=\"true\"/>\\n    <property name=\"sessionValidationScheduler\" ref=\"sessionValidationScheduler\"/>\\n    <property name=\"sessionDAO\" ref=\"sessionDAO\"/>\\n</bean>\\n\\x3c!-- 安全管理器 --\\x3e\\n<bean id=\"securityManager\" class=\"org.apache.shiro.mgt.DefaultSecurityManager\">\\n    <property name=\"realms\">\\n        <list><ref bean=\"userRealm\"/></list>\\n    </property>\\n    <property name=\"sessionManager\" ref=\"sessionManager\"/>\\n    <property name=\"cacheManager\" ref=\"cacheManager\"/>\\n</bean>\\n\\x3c!-- 相当于调用SecurityUtils.setSecurityManager(securityManager) --\\x3e\\n<bean class=\"org.springframework.beans.factory.config.MethodInvokingFactoryBean\">\\n<property name=\"staticMethod\" value=\"org.apache.shiro.SecurityUtils.setSecurityManager\"/>\\n    <property name=\"arguments\" ref=\"securityManager\"/>\\n</bean>\\n\\x3c!-- Shiro生命周期处理器--\\x3e\\n<bean id=\"lifecycleBeanPostProcessor\" class=\"org.apache.shiro.spring\\n        .LifecycleBeanPostProcessor\"/>\\n')])]),e._v(\" \"),s(\"div\",{staticClass:\"line-numbers-wrapper\"},[s(\"span\",{staticClass:\"line-number\"},[e._v(\"1\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"2\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"3\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"4\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"5\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"6\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"7\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"8\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"9\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"10\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"11\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"12\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"13\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"14\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"15\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"16\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"17\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"18\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"19\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"20\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"21\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"22\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"23\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"24\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"25\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"26\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"27\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"28\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"29\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"30\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"31\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"32\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"33\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"34\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"35\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"36\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"37\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"38\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"39\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"40\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"41\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"42\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"43\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"44\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"45\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"46\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"47\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"48\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"49\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"50\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"51\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"52\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"53\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"54\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"55\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"56\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"57\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"58\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"59\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"60\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"61\")]),s(\"br\")])]),s(\"p\",[e._v(\"可以看出，只要把之前的ini配置翻译为此处的spring xml配置方式即可，无须多解释。 LifecycleBeanPostProcessor 用于在实现了Initializable接口的Shiro Bean初始化时调用Initializable接口回调，在实现了Destroyable接口的Shiro bean销毁时调用Destroyable接口回调\")]),e._v(\" \"),s(\"h3\",{attrs:{id:\"web应用\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#web应用\"}},[e._v(\"#\")]),e._v(\" Web应用\")]),e._v(\" \"),s(\"p\",[e._v(\"Web应用和普通JavaSE应用的某些配置是类似的，此处只提供一些不一样的配置\")]),e._v(\" \"),s(\"div\",{staticClass:\"language- line-numbers-mode\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v('\\x3c!-- 会话Cookie模板 --\\x3e\\n<bean id=\"sessionIdCookie\" class=\"org.apache.shiro.web.servlet.SimpleCookie\">\\n    <constructor-arg value=\"sid\"/>\\n    <property name=\"httpOnly\" value=\"true\"/>\\n    <property name=\"maxAge\" value=\"180000\"/>\\n</bean>\\n\\x3c!-- 会话管理器 --\\x3e\\n<bean id=\"sessionManager\" \\nclass=\"org.apache.shiro.web.session.mgt.DefaultWebSessionManager\">\\n    <property name=\"globalSessionTimeout\" value=\"1800000\"/>\\n    <property name=\"deleteInvalidSessions\" value=\"true\"/>\\n    <property name=\"sessionValidationSchedulerEnabled\" value=\"true\"/>\\n    <property name=\"sessionValidationScheduler\" ref=\"sessionValidationScheduler\"/>\\n    <property name=\"sessionDAO\" ref=\"sessionDAO\"/>\\n    <property name=\"sessionIdCookieEnabled\" value=\"true\"/>\\n    <property name=\"sessionIdCookie\" ref=\"sessionIdCookie\"/>\\n</bean>\\n\\x3c!-- 安全管理器 --\\x3e\\n<bean id=\"securityManager\" class=\"org.apache.shiro.web.mgt.DefaultWebSecurityManager\">\\n<property name=\"realm\" ref=\"userRealm\"/>\\n    <property name=\"sessionManager\" ref=\"sessionManager\"/>\\n    <property name=\"cacheManager\" ref=\"cacheManager\"/>\\n</bean>\\n')])]),e._v(\" \"),s(\"div\",{staticClass:\"line-numbers-wrapper\"},[s(\"span\",{staticClass:\"line-number\"},[e._v(\"1\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"2\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"3\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"4\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"5\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"6\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"7\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"8\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"9\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"10\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"11\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"12\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"13\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"14\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"15\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"16\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"17\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"18\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"19\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"20\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"21\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"22\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"23\")]),s(\"br\")])]),s(\"ol\",[s(\"li\",[e._v(\"sessonIdCookie使用于生产Session ID Cookie的模板\")]),e._v(\" \"),s(\"li\",[e._v(\"会话管理器使用用于web环境的DefaultWebSessionManager\")]),e._v(\" \"),s(\"li\",[e._v(\"安全管理器使用用于web环境的DefaultWebSecurityManager\")])]),e._v(\" \"),s(\"div\",{staticClass:\"language- line-numbers-mode\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v('\\x3c!-- 基于Form表单的身份验证过滤器 --\\x3e\\n<bean id=\"formAuthenticationFilter\" \\nclass=\"org.apache.shiro.web.filter.authc.FormAuthenticationFilter\">\\n    <property name=\"usernameParam\" value=\"username\"/>\\n    <property name=\"passwordParam\" value=\"password\"/>\\n    <property name=\"loginUrl\" value=\"/login.jsp\"/>\\n</bean>\\n\\x3c!-- Shiro的Web过滤器 --\\x3e\\n<bean id=\"shiroFilter\" class=\"org.apache.shiro.spring.web.ShiroFilterFactoryBean\">\\n    <property name=\"securityManager\" ref=\"securityManager\"/>\\n    <property name=\"loginUrl\" value=\"/login.jsp\"/>\\n    <property name=\"unauthorizedUrl\" value=\"/unauthorized.jsp\"/>\\n    <property name=\"filters\">\\n        <util:map>\\n            <entry key=\"authc\" value-ref=\"formAuthenticationFilter\"/>\\n        </util:map>\\n    </property>\\n    <property name=\"filterChainDefinitions\">\\n        <value>\\n            /index.jsp = anon\\n            /unauthorized.jsp = anon\\n            /login.jsp = authc\\n            /logout = logout\\n            /** = user\\n        </value>\\n    </property>\\n</bean>\\n')])]),e._v(\" \"),s(\"div\",{staticClass:\"line-numbers-wrapper\"},[s(\"span\",{staticClass:\"line-number\"},[e._v(\"1\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"2\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"3\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"4\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"5\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"6\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"7\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"8\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"9\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"10\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"11\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"12\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"13\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"14\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"15\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"16\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"17\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"18\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"19\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"20\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"21\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"22\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"23\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"24\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"25\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"26\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"27\")]),s(\"br\")])]),s(\"ol\",[s(\"li\",[e._v(\"formAuthenticationFilter 为基于 Form 表单的身份验证过滤器；此处可以再添加自己的 Filter bean 定义\")]),e._v(\" \"),s(\"li\",[e._v(\"shiroFilter：此处使用 ShiroFilterFactoryBean 来创建 ShiroFilter 过滤器；filters 属性用于定义自己的过滤器，即 ini 配置中的 [filters] 部分；filterChainDefinitions 用于声明 url 和 filter 的关系，即 ini 配置中的 [urls] 部分\")])]),e._v(\" \"),s(\"p\",[e._v(\"接着在web.xml进行如下配置\")]),e._v(\" \"),s(\"div\",{staticClass:\"language- line-numbers-mode\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v(\"<context-param>\\n    <param-name>contextConfigLocation</param-name>\\n    <param-value>\\n        classpath:spring-beans.xml,\\n        classpath:spring-shiro-web.xml\\n    </param-value>\\n    </context-param>\\n    <listener>\\n        <listener-class>\\n        org.springframework.web.context.ContextLoaderListener\\n        </listener-class>\\n    </listener>\\n\")])]),e._v(\" \"),s(\"div\",{staticClass:\"line-numbers-wrapper\"},[s(\"span\",{staticClass:\"line-number\"},[e._v(\"1\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"2\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"3\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"4\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"5\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"6\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"7\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"8\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"9\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"10\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"11\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"12\")]),s(\"br\")])]),s(\"p\",[e._v(\"通过 ContextLoaderListener 加载 contextConfigLocation 指定的 Spring 配置文件\")]),e._v(\" \"),s(\"div\",{staticClass:\"language- line-numbers-mode\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v(\"<filter>\\n    <filter-name>shiroFilter</filter-name>\\n    <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>\\n    <init-param>\\n        <param-name>targetFilterLifecycle</param-name>\\n        <param-value>true</param-value>\\n    </init-param>\\n</filter>\\n<filter-mapping>\\n    <filter-name>shiroFilter</filter-name>\\n    <url-pattern>/*</url-pattern>\\n</filter-mapping>\\n\")])]),e._v(\" \"),s(\"div\",{staticClass:\"line-numbers-wrapper\"},[s(\"span\",{staticClass:\"line-number\"},[e._v(\"1\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"2\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"3\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"4\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"5\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"6\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"7\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"8\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"9\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"10\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"11\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"12\")]),s(\"br\")])]),s(\"p\",[e._v(\"DelegatingFilterProxy 会自动到 Spring 容器中查找名字为 shiroFilter 的 bean 并把 filter 请求交给它处理\")]),e._v(\" \"),s(\"h3\",{attrs:{id:\"shiro权限注解\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro权限注解\"}},[e._v(\"#\")]),e._v(\" Shiro权限注解\")]),e._v(\" \"),s(\"p\",[e._v(\"Shiro提供了相应的注解用于权限控制，如果使用这些注解就需要使用AOP的功能来进行判断，Shiro提供了Spring AOP集成用于权限注解的解析和验证为了测试，此处用了Spring MVC来测试Shiro注解，当然Shiro注解不仅可以再web环境中使用，在独立的JavaSE环境中也是可以使用的\")]),e._v(\" \"),s(\"p\",[e._v(\"在spring-mvc.xml配置文件添加Shiro Spring AOP权限注解的支持：\")]),e._v(\" \"),s(\"div\",{staticClass:\"language- line-numbers-mode\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v('<aop:config proxy-target-class=\"true\"></aop:config>\\n<bean class=\"\\norg.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor\">\\n    <property name=\"securityManager\" ref=\"securityManager\"/>\\n</bean>\\n')])]),e._v(\" \"),s(\"div\",{staticClass:\"line-numbers-wrapper\"},[s(\"span\",{staticClass:\"line-number\"},[e._v(\"1\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"2\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"3\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"4\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"5\")]),s(\"br\")])]),s(\"p\",[e._v(\"接着就可以在相应的控制器中使用如下方式进行注解：\")]),e._v(\" \"),s(\"div\",{staticClass:\"language- line-numbers-mode\"},[s(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[s(\"code\",[e._v('@RequiresRoles(\"admin\")\\n@RequestMapping(\"/hello\")\\npublic String hello() {\\n    return \"hello world\";\\n}\\n')])]),e._v(\" \"),s(\"div\",{staticClass:\"line-numbers-wrapper\"},[s(\"span\",{staticClass:\"line-number\"},[e._v(\"1\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"2\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"3\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"4\")]),s(\"br\"),s(\"span\",{staticClass:\"line-number\"},[e._v(\"5\")]),s(\"br\")])]),s(\"h3\",{attrs:{id:\"权限注解\"}},[s(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#权限注解\"}},[e._v(\"#\")]),e._v(\" 权限注解\")]),e._v(\" \"),s(\"ul\",[s(\"li\",[e._v(\"@RequiresAuthentication\\n\"),s(\"ul\",[s(\"li\",[e._v(\"表示当前Subject已经通过login进行了身份验证，即Subject.isAuthenticated()返回true\")])])]),e._v(\" \"),s(\"li\",[e._v(\"@RequiresUser\\n\"),s(\"ul\",[s(\"li\",[e._v(\"表示当前Subject已经身份验证或者通过记住我登录的\")])])]),e._v(\" \"),s(\"li\",[e._v(\"@RequiresGuest\\n\"),s(\"ul\",[s(\"li\",[e._v(\"表示当前Subject没有身份验证或通过记住我登录，即是游客身份\")])])]),e._v(\" \"),s(\"li\",[e._v(\"@RequiresRoles(value={“admin”, “user”}, logical= Logical.AND)\\n\"),s(\"ul\",[s(\"li\",[e._v(\"表示当前的Subject需要角色admin和user\")])])]),e._v(\" \"),s(\"li\",[e._v(\"@RequiresPermissions (value={“user:a”, “user:b”}, logical= Logical.OR)\\n\"),s(\"ul\",[s(\"li\",[e._v(\"表示当前Subject需要权限user:a或user:b\")])])])])])}),[],!1,null,null,null);a.default=r.exports}}]);","extractedComments":[]}