{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{460:function(e,r,n){\"use strict\";n.r(r);var a=n(0),s=Object(a.a)({},(function(){var e=this,r=e.$createElement,a=e._self._c||r;return a(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[a(\"h2\",{attrs:{id:\"shiro��e\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro��e\"}},[e._v(\"#\")]),e._v(\" Shiro��Ȩ\")]),e._v(\" \"),a(\"h4\",{attrs:{id:\"_3����e��ʽ\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#_3����e��ʽ\"}},[e._v(\"#\")]),e._v(\" 3����Ȩ��ʽ\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro֧��3����Ȩ��ʽ\\n    ���ʽ��ͨ��дif/else��Ȩ�������\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/d5f603b4.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"    ע��ʽ��ͨ����ִ�е�Java�����Ϸ�����Ӧ��ע�����\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/096f15d5.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"    JSP/GSP��ǩ����JSP/GSPͨ����Ӧ�ı�ǩ���\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/faa1a43b.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"h4\",{attrs:{id:\"���ڽ�l�k��ʿ��oi���ʽ��l��\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#���ڽ�l�k��ʿ��oi���ʽ��l��\"}},[e._v(\"#\")]),e._v(\" ���ڽ�ɫ�ķ��ʿ��ƣ���ʽ��ɫ��\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"��ν��ʽ��ɫ��ָ����ֱ���ɽ�ɫ���ж��Ƿ����Ȩ�ޣ����ַ�ʽ���ü򵥣���������̫�֣����ĳһ���ɫ��Ӧ��Ȩ�޷���\\n�˸ı䣬����Ҫ�޸ĺ�ɾ���������\\n\\n1.����shiro.ini����\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/e11e460f.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"2.��д������\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/8c5ec043.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro�ṩ��hasRole��/hasAllRoles���ж��Ƿ�ӵ��ĳ����ɫ������û���ṩhasAnyRole���ж��Ƿ�ӵ��һЩ��ɫ�е�\\nĳһ���������Ҫ�жϣ�����Ҫʹ��checkRole������������������ͬ���ǣ�����֤ʧ�ܻ��׳��쳣\\n\")])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"������դ�k��ʿ��oi���ʽ��l��\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#������դ�k��ʿ��oi���ʽ��l��\"}},[e._v(\"#\")]),e._v(\" ������Դ�ķ��ʿ��ƣ���ʽ��ɫ��\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"1.����shiro.ini����\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/2e8e64a7.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"2.��д������\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/b378c171.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"h4\",{attrs:{id:\"permission���ַ���ͨ���e�ޣ�\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#permission���ַ���ͨ���e�ޣ�\"}},[e._v(\"#\")]),e._v(\" Permission���ַ���ͨ���Ȩ�ޣ�\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('\":\"����ʾ��Դ/����/ʵ���ķָ�\\n\",\"����ʾ��Դ�ķָ�\\n\"*\"����ʾ������Դ/����/ʵ��\\n\\n1.������Դ����Ȩ��\\n  subject().checkPermissions(\"system:user:update\"); // ��֤�û��Ƿ�ӵ����Դsystem:user��updateȨ\\n  ��\\n2.������Դ�Ķ��Ȩ��\\n  role=system:user:update,system:user:delete // ini����\\n  subject().checkPermissions(\"system:user:update\", \"system:user:delete\"); //����û��Ƿ�ӵ����Դ\\n  system:user��update��deleteȨ��\\n  �����Լ�дΪ\\n  role=\"system:user:update,delete\"\\n  subject().checkPermissions(\"system:user:update,delete\");\\n  ע��ͨ��subject().checkPermissions(\"system:user:update,delete\")����֤\\n  role=system:user:update,system:user:delete��deleteȨ���ǿ��Եģ����Ƿ��������򲻳���\\n3.������Դ��ȫ��Ȩ��\\n  ini����\\n    role=\"system:user:create,update,delete,view\"\\n    role=system:user:*\\n    role53=system:user // ���Ƽ�\\n  Ȩ�޼��\\n    subject().checkPermissions(\"system:user:create,delete,update:view\");\\n    subject().checkPermissions(\"system:user:*\");\\n    subject().checkPermissions(\"system:user\");\\n  ע��ͨ����system:user:*����֤��system:user:create,delete,update:view�����ԣ����Ƿ������ǲ�������\\n4.������Դȫ��Ȩ��\\n  ini����\\n    role=*:view\\n  Ȩ�޼��\\n    subject().checkPermissions(\"user:view\");\\n')])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"��e����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#��e����\"}},[e._v(\"#\")]),e._v(\" ��Ȩ����\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/fa7bf879.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"1.���ȵ���Subject.isPermitted*/hasRole*�ӿڣ����ί�и�SecurityManager�������� SecurityManager ��\\n  �Ż�ί�и� Authorizer\\n2.Authorizer ����������Ȩ�ߣ�������ǵ����� isPermitted(��user:view��)�������Ȼ�ͨ�� \\n  PermissionResolver���ַ���ת������Ӧ��Permission ʵ��\\n3.�ڽ�����Ȩ֮ǰ����������Ӧ�� Realm ��ȡ Subject ��Ӧ�Ľ�ɫ/Ȩ������ƥ�䴫��Ľ�ɫ/Ȩ��\\n4.Authorizer ���ж� Realm �Ľ�ɫ/Ȩ���Ƿ�ʹ����ƥ�䣬����ж�� Realm����ί�и� \\n  ModularRealmAuthorizer����ѭ���жϣ����ƥ���� isPermitted*/hasRole* �᷵�� true�����򷵻� false \\n  ��ʾ��Ȩʧ��\\n\")])]),e._v(\" \"),a(\"h2\",{attrs:{id:\"shiro-web����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro-web����\"}},[e._v(\"#\")]),e._v(\" Shiro-Web����\")]),e._v(\" \"),a(\"h4\",{attrs:{id:\"shiro-web���n���\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro-web���n���\"}},[e._v(\"#\")]),e._v(\" Shiro-Web���ɲ���\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"1.����maven-web��Ŀ���������jar��\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/2a8604ca.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"2.web.xml������Shiro�������\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/53a24789.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}}),e._v(\" \"),a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/1f73f3e6.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"3.����shiro.ini�����ļ�\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/4bf992e9.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"4.���ӵ�¼ҳ��\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/72ba6b1f.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"5.����LoginServlet\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/81b09707.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"h2\",{attrs:{id:\"shiro-�u����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro-�u����\"}},[e._v(\"#\")]),e._v(\" Shiro-�Ự����\")]),e._v(\" \"),a(\"h4\",{attrs:{id:\"�u����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#�u����\"}},[e._v(\"#\")]),e._v(\" �Ự����\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro�ṩ����������ҵ���Ự�������ܣ��������ڵײ�����������JavaSE����JavaEE�������ṩ�˻Ự�������Ựʱ���\\n�����Ự�洢/�־û��������޹صļ�Ⱥ��ʧЧ/����֧�֡���Web��͸��֧�֡�SSO�����¼��֧�ֵ����ԡ���ֱ��ʹ��\\nShiro�ĻỰ��������ֱ���滻��Web�����ĻỰ����\\n\")])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"�u\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#�u\"}},[e._v(\"#\")]),e._v(\" �Ự\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro�ĻỰ֧�ֲ���������JavaSE��ʹ�ã�Ҳ������JavaEE��ʹ�ã���ʹ�õķ�ʽ��һ����\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/f57532da.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"��¼�ɹ���ʹ��Subject.getSession()���ɻ�ȡ�Ự����ȼ���Subject.getSession(True),����ǰ���û�д���\\nSession������ᴴ��һ��������Subject.getSession(False)�������ǰû�д���Session������᷵��null\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/5a9d25b2.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"��ȡ��ǰ�Ự��Ψһ��ʶ\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/31410d77.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"��ȡ��ǰSubject��������ַ���õ�ַ����HostAuthenticationToken.getHost()�ṩ��\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/96bb96c2.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"��ȡ/���õ�ǰSession�Ĺ���ʱ�䣬���������Ĭ�ϵ��ǻỰ��������ȫ�ֹ���ʱ��\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/178e8156.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"��ȡ�Ự������ʱ�估������ʱ�䣬�����JavaSEӦ����Ҫ�Լ����ڵ���session.touch()ȥ����������ʱ�䣻�����\\nWebӦ�ã�ÿ�ν���ShiroFilter�����Զ�����session.touch()������������ʱ��\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/27fe6311.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"���»Ự������ʱ�估���ٻỰ����Subject.logout()ʱ���Զ�����stop���������ٻỰ�������web�У�����\\njavax.servlet.http.HttpSession. invalidate()Ҳ�����stop���������ٻỰ\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/ee20d779.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"����/��ȡ/ɾ���Ự���ԣ��������Ự��Χ�ڶ����Զ���Щ���Խ��в���\\nShiro�ṩ�ĻỰ��������JavaEE��JavaSE���������������κεײ����������Զ���ʹ�ã��������ĻỰģ��\\n\")])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"�u������\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#�u������\"}},[e._v(\"#\")]),e._v(\" �Ự������\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"�Ự������������Ӧ��������Subject�ĻỰ�Ĵ�����ά����ɾ����ʧЧ����֤�ȹ�������Shiro�ĺ���������������\\nSecurityManager��ֱ�Ӽ̳���SessionManager�����ṩ��SessionSecurityManagerʵ��ֱ�ӰѻỰ����ί�и���Ӧ\\n��SessionManager��DefaultSecurityManager��DefaultWebSecurityManagerĬ��SecurityManager���̳���\\nSessionSecurityManager\\n\\nSecurityManager�ṩ�����½ӿڣ�\\n    Session start(SessionContext sessionContext); // �����Ự\\n    Session getSession(SessionKey sessionKey) throws SessionException; // ���ݻỰkey��ȡ�Ự\\n��������Web������WebSessionManager���ṩ�����½ӿ�;\\n    boolean isSevletContainerSessions(); // �Ƿ�ʹ��Servlet�����ĻỰ\\nShiro���ṩ��ValidatingSessionManager�������ʲ����ڻỰ\\n    void validateSessions(); // ��֤���лỰ�Ƿ����     \\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/850cdc53.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro�ṩ��3��Ĭ��ʵ��\\n    DefaultSessionManager��DefaultSecurityManagerʹ�õ�Ĭ��ʵ�֣�����JavaSE����\\n    ServletContainerSessionManager��DefaultWebSessionManagerʹ�õ�Ĭ��ʵ�֣�����web��������ֱ��ʹ��\\n    servlet�����ĻỰ\\n    DefaultWebSessionManager������Web������ʵ�֣������ServletContainerSessionManager���Լ�ά���Ż�\\n    ����������servlet�����ĻỰ\\n    \\n�滻SecurityManagerĬ�ϵ�SessionManager������ini������\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/ef0e1040.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"web�����µ�ini����\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/ff0e2b01.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"����������ûỰ��ȫ�ֹ���ʱ�䣨����Ϊ��λ����Ĭ��Ϊ30����\\n    sessionManager.globalSessionTimeout = 1800000\\n    \\nĬ������£�globalSessionTimeout��Ӧ�ø�����Session�����Ե�������ÿ��Session��timeout������Ϊÿ��\\nSession�����䳬ʱʱ�䣬���⣬���ʹ��ServletContainerSessionManager���лỰ������Session�ĳ�ʱ����\\n�ڵײ�Servlet�����ĳ�ʱʱ�䣬����web.xml�����ûỰ�ĳ�ʱʱ�䣬��λΪ����\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/f38888f2.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"��Servlet�����У�Ĭ��ʹ��JSESSION Cookieά���Ự���һỰĬ���Ǹ������󶨵ģ���Ĭд����¿�����Ҫʹ���Լ���\\n�Ự���ƣ���ʱ���ǿ���ʹ��DefaultWebSessionManager��ά���Ự\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/900d6713.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"sessionIdCookie��sessionManager�����ỰCookie��ģ��\\nsessionIdCookie.name������Cookie���֣�Ĭ��ΪJSESSIONID\\nsessionIdCookie.domain������Cookie��������Ĭ�Ͽգ�����ǰ���ʵ�����\\nsessionIdCookie.path������Cookie��·����Ĭ�Ͽգ����洢����������\\nsessionIdCookie.maxAge������Cookie����ʱ�䣬��Ϊ��λ��Ĭ��-1�����ر������ʱCookie����\\nsessionIdCookie.htppOnly���������ΪTrue����ͻ��˲��ᱩ¶�ͻ��˽ű����룬ʹ��httpOnly�����ڼ���ĳЩ����\\n  �Ŀ�վ��ű�����\\nsessionManager.sessionIdCookieEnabled���Ƿ�����/����Session Id Cookie��Ĭ��������\\n\")])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"�u������-2\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#�u������-2\"}},[e._v(\"#\")]),e._v(\" �Ự������\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"�Ự��������Ҫ���ڼ����Ự���������ڼ�ֹͣ�¼�\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/3bae15ad.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"���ֻ�����ĳһ���¼������Լ̳�SessionListenerAdapter\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/bf20338c.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"�� shiro-web.ini �����ļ��п��Խ��������������ûỰ�������� \\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/d1c29aa9.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"h2\",{attrs:{id:\"shiro-�������\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro-�������\"}},[e._v(\"#\")]),e._v(\" Shiro-�������\")]),e._v(\" \"),a(\"h4\",{attrs:{id:\"�������\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#�������\"}},[e._v(\"#\")]),e._v(\" �������\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro�ṩ��������Spring��Cache���󣬼�Shiro������ʵ��Cache�����Ƕ�Cache��ʵ���˳��󣬷��������ͬ�ײ��\\nCacheʵ��\\n\")])]),e._v(\" \"),a(\"h6\",{attrs:{id:\"shiro�s��cache�ӿ�\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro�s��cache�ӿ�\"}},[e._v(\"#\")]),e._v(\" Shiro�ṩ��Cache�ӿ�\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/65987d54.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"h6\",{attrs:{id:\"shiro�s��cachemanager�ӿ�\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro�s��cachemanager�ӿ�\"}},[e._v(\"#\")]),e._v(\" Shiro�ṩ��CacheManager�ӿ�\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/17ca830c.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"h6\",{attrs:{id:\"shiro���s��cachemanageraware����ע��cachemanager\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro���s��cachemanageraware����ע��cachemanager\"}},[e._v(\"#\")]),e._v(\" Shiro���ṩ��CacheManagerAware����ע��CacheManager\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/2d67c824.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro���ڲ������DefaultSecurityManager�����Զ������Ӧ�Ķ�����Realm���Ƿ�ʵ����CacheManagerAware��\\n�Զ�ע����Ӧ��CacheManager\\n\")])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"realm����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#realm����\"}},[e._v(\"#\")]),e._v(\" Realm����\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro�ṩ��CachingRealm����ʵ����CacheManagerAware�ӿڣ��ṩ��һЩ����Ļ���ʵ�֣����� \\nAuthenticatingRealm��AuthorizingRealm �ֱ��ṩ�˶�AuthenticationInfo��AuthorizationInfo ��Ϣ��\\n����\\n\")])]),e._v(\" \"),a(\"h6\",{attrs:{id:\"ini����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#ini����\"}},[e._v(\"#\")]),e._v(\" ini����\")]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/374b2213.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"userRealm.cacheEnabled�����û��棬Ĭ��False\\nuserRealm.authenticationCachingEnabled������������֤���棬������AuthenticationInfo��Ϣ��Ĭ��False\\ncacheManager��������������˴�ʹ��EhCacheManager����Ehcacheʵ�֣���Ҫ������Ӧ������\\n\")])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"session����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#session����\"}},[e._v(\"#\")]),e._v(\" Session����\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"������������SecurityManager��CacheManagerʱ����\\n    securityManager.cacheManager = $cacheManager\\n����������SessionManagerʱ��\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/f4ca00ec.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"��securityManagerʵ����SessionSecurityManager������Զ��ж�SessionManager�Ƿ�ʵ����\\nCacheManagerAware�ӿڣ����ʵ��������CacheManager���ø�����Ȼ��SessionManager���ж���Ӧ��\\nsessionDAO�Ƿ�ʵ����CacheManagerAware�����ʵ���˻��CacheManager���ø���\\n\\n����sessionDAO����ͨ�������������û��������\\n\")])]),e._v(\" \"),a(\"p\",[a(\"img\",{attrs:{src:n(!function(){var e=new Error(\"Cannot find module '../../../images/cc2cf287.png'\");throw e.code=\"MODULE_NOT_FOUND\",e}()),alt:\"\"}})]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"activeSessionsCacheName Ĭ�Ͼ��� shiro-activeSessionCache\\n\")])]),e._v(\" \"),a(\"h2\",{attrs:{id:\"shiro-spring����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro-spring����\"}},[e._v(\"#\")]),e._v(\" Shiro-Spring����\")]),e._v(\" \"),a(\"h4\",{attrs:{id:\"��spring����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#��spring����\"}},[e._v(\"#\")]),e._v(\" ��Spring����\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro���������JavaBean/POJOʽ����������зǳ�����ʹ��Spring����������������Էǳ�����Ĵ�ini����Ǩ�Ƶ�\\nSpring���й�������֧��JavaEEӦ�ú�WebӦ�õļ��ɡ�\\n�赼��shiro-spring��spring-context�������\\nspring-beans.xml�����ļ��ṩ�˻��������DataSource��DAO��Service���������\\n\")])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"javaseӧ��\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#javaseӧ��\"}},[e._v(\"#\")]),e._v(\" JavaSEӦ��\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('spring-shiro.xml�ṩ����ͨJavaSE����Ӧ�õ�spring���ã�\\n    \\x3c!-- ��������� ʹ��Ehcacheʵ�� --\\x3e\\n    <bean id=\"cacheManager\" class=\"org.apache.shiro.cache.ehcache.EhCacheManager\">\\n        <property name=\"cacheManagerConfigFile\" value=\"classpath:ehcache.xml\"/>\\n    </bean>\\n    \\x3c!-- ƾ֤ƥ���� --\\x3e\\n    <bean id=\"credentialsMatcher\" class=\"com.github.zhangkaitao.shiro.chapter12.credentials\\n          .RetryLimitHashedCredentialsMatcher\">\\n        <constructor-arg ref=\"cacheManager\"/>\\n        <property name=\"hashAlgorithmName\" value=\"md5\"/>\\n        <property name=\"hashIterations\" value=\"2\"/>\\n        <property name=\"storedCredentialsHexEncoded\" value=\"true\"/>\\n    </bean>\\n    \\x3c!-- Realmʵ�� --\\x3e\\n    <bean id=\"userRealm\" class=\"com.github.zhangkaitao.shiro.chapter12.realm.UserRealm\">\\n        <property name=\"userService\" ref=\"userService\"/>\\n        <property name=\"credentialsMatcher\" ref=\"credentialsMatcher\"/>\\n        <property name=\"cachingEnabled\" value=\"true\"/>\\n        <property name=\"authenticationCachingEnabled\" value=\"true\"/>\\n        <property name=\"authenticationCacheName\" value=\"authenticationCache\"/>\\n        <property name=\"authorizationCachingEnabled\" value=\"true\"/>\\n        <property name=\"authorizationCacheName\" value=\"authorizationCache\"/>\\n    </bean>\\n    \\x3c!-- �ỰID������ --\\x3e\\n    <bean id=\"sessionIdGenerator\" \\n    class=\"org.apache.shiro.session.mgt.eis.JavaUuidSessionIdGenerator\"/>\\n    \\x3c!-- �ỰDAO --\\x3e\\n    <bean id=\"sessionDAO\" \\n    class=\"org.apache.shiro.session.mgt.eis.EnterpriseCacheSessionDAO\">\\n        <property name=\"activeSessionsCacheName\" value=\"shiro-activeSessionCache\"/>\\n        <property name=\"sessionIdGenerator\" ref=\"sessionIdGenerator\"/>\\n    </bean>\\n    \\x3c!-- �Ự��֤������ --\\x3e\\n    <bean id=\"sessionValidationScheduler\" class=\"org.apache.shiro.session.mgt.quartz\\n          .QuartzSessionValidationScheduler\">\\n        <property name=\"sessionValidationInterval\" value=\"1800000\"/>\\n        <property name=\"sessionManager\" ref=\"sessionManager\"/>\\n    </bean>\\n    \\x3c!-- �Ự������ --\\x3e\\n    <bean id=\"sessionManager\" class=\"org.apache.shiro.session.mgt.DefaultSessionManager\">\\n        <property name=\"globalSessionTimeout\" value=\"1800000\"/>\\n        <property name=\"deleteInvalidSessions\" value=\"true\"/>\\n        <property name=\"sessionValidationSchedulerEnabled\" value=\"true\"/>\\n       <property name=\"sessionValidationScheduler\" ref=\"sessionValidationScheduler\"/>\\n        <property name=\"sessionDAO\" ref=\"sessionDAO\"/>\\n    </bean>\\n    \\x3c!-- ��ȫ������ --\\x3e\\n    <bean id=\"securityManager\" class=\"org.apache.shiro.mgt.DefaultSecurityManager\">\\n        <property name=\"realms\">\\n            <list><ref bean=\"userRealm\"/></list>\\n        </property>\\n        <property name=\"sessionManager\" ref=\"sessionManager\"/>\\n        <property name=\"cacheManager\" ref=\"cacheManager\"/>\\n    </bean>\\n    \\x3c!-- �൱�ڵ���SecurityUtils.setSecurityManager(securityManager) --\\x3e\\n    <bean class=\"org.springframework.beans.factory.config.MethodInvokingFactoryBean\">\\n    <property name=\"staticMethod\" value=\"org.apache.shiro.SecurityUtils.setSecurityManager\"/>\\n        <property name=\"arguments\" ref=\"securityManager\"/>\\n    </bean>\\n    \\x3c!-- Shiro�������ڴ�����--\\x3e\\n    <bean id=\"lifecycleBeanPostProcessor\" class=\"org.apache.shiro.spring\\n          .LifecycleBeanPostProcessor\"/>\\n    \\n���Կ�����ֻҪ��֮ǰ��ini���÷���Ϊ�˴���spring xml���÷�ʽ���ɣ��������͡� \\nLifecycleBeanPostProcessor ������ʵ����Initializable�ӿڵ�Shiro Bean��ʼ��ʱ����Initializable\\n�ӿڻص�����ʵ����Destroyable�ӿڵ�Shiro bean����ʱ����Destroyable�ӿڻص�\\n')])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"webӧ��\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#webӧ��\"}},[e._v(\"#\")]),e._v(\" WebӦ��\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('WebӦ�ú���ͨJavaSEӦ�õ�ĳЩ���������Ƶģ��˴�ֻ�ṩһЩ��һ��������\\n    \\x3c!-- �ỰCookieģ�� --\\x3e\\n    <bean id=\"sessionIdCookie\" class=\"org.apache.shiro.web.servlet.SimpleCookie\">\\n        <constructor-arg value=\"sid\"/>\\n        <property name=\"httpOnly\" value=\"true\"/>\\n        <property name=\"maxAge\" value=\"180000\"/>\\n    </bean>\\n    \\x3c!-- �Ự������ --\\x3e\\n    <bean id=\"sessionManager\" \\n    class=\"org.apache.shiro.web.session.mgt.DefaultWebSessionManager\">\\n        <property name=\"globalSessionTimeout\" value=\"1800000\"/>\\n        <property name=\"deleteInvalidSessions\" value=\"true\"/>\\n        <property name=\"sessionValidationSchedulerEnabled\" value=\"true\"/>\\n        <property name=\"sessionValidationScheduler\" ref=\"sessionValidationScheduler\"/>\\n        <property name=\"sessionDAO\" ref=\"sessionDAO\"/>\\n        <property name=\"sessionIdCookieEnabled\" value=\"true\"/>\\n        <property name=\"sessionIdCookie\" ref=\"sessionIdCookie\"/>\\n    </bean>\\n    \\x3c!-- ��ȫ������ --\\x3e\\n    <bean id=\"securityManager\" class=\"org.apache.shiro.web.mgt.DefaultWebSecurityManager\">\\n    <property name=\"realm\" ref=\"userRealm\"/>\\n        <property name=\"sessionManager\" ref=\"sessionManager\"/>\\n        <property name=\"cacheManager\" ref=\"cacheManager\"/>\\n    </bean>\\n\\n1.sessonIdCookieʹ��������Session ID Cookie��ģ��\\n2.�Ự������ʹ������web������DefaultWebSessionManager\\n3.��ȫ������ʹ������web������DefaultWebSecurityManager\\n\\n\\x3c!-- ����Form������������֤������ --\\x3e\\n<bean id=\"formAuthenticationFilter\" \\nclass=\"org.apache.shiro.web.filter.authc.FormAuthenticationFilter\">\\n    <property name=\"usernameParam\" value=\"username\"/>\\n    <property name=\"passwordParam\" value=\"password\"/>\\n    <property name=\"loginUrl\" value=\"/login.jsp\"/>\\n</bean>\\n\\x3c!-- Shiro��Web������ --\\x3e\\n<bean id=\"shiroFilter\" class=\"org.apache.shiro.spring.web.ShiroFilterFactoryBean\">\\n    <property name=\"securityManager\" ref=\"securityManager\"/>\\n    <property name=\"loginUrl\" value=\"/login.jsp\"/>\\n    <property name=\"unauthorizedUrl\" value=\"/unauthorized.jsp\"/>\\n    <property name=\"filters\">\\n        <util:map>\\n            <entry key=\"authc\" value-ref=\"formAuthenticationFilter\"/>\\n        </util:map>\\n    </property>\\n    <property name=\"filterChainDefinitions\">\\n        <value>\\n            /index.jsp = anon\\n            /unauthorized.jsp = anon\\n            /login.jsp = authc\\n            /logout = logout\\n            /** = user\\n        </value>\\n    </property>\\n</bean>\\n\\n1.formAuthenticationFilter Ϊ���� Form ������������֤���������˴������������Լ��� Filter bean ����\\n2.shiroFilter���˴�ʹ�� ShiroFilterFactoryBean ������ ShiroFilter ��������filters �������ڶ����Լ��Ĺ��������� ini ������\\n  �� [filters] ���֣�filterChainDefinitions �������� url �� filter �Ĺ�ϵ���� ini �����е� [urls] ����\\n  \\n������web.xml������������\\n    <context-param>\\n        <param-name>contextConfigLocation</param-name>\\n        <param-value>\\n            classpath:spring-beans.xml,\\n            classpath:spring-shiro-web.xml\\n        </param-value>\\n    </context-param>\\n    <listener>\\n       <listener-class>\\n    org.springframework.web.context.ContextLoaderListener\\n    </listener-class>\\n    </listener>\\n    \\nͨ�� ContextLoaderListener ���� contextConfigLocation ָ���� Spring �����ļ�\\n    <filter>\\n        <filter-name>shiroFilter</filter-name>\\n        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>\\n        <init-param>\\n            <param-name>targetFilterLifecycle</param-name>\\n            <param-value>true</param-value>\\n        </init-param>\\n    </filter>\\n    <filter-mapping>\\n        <filter-name>shiroFilter</filter-name>\\n        <url-pattern>/*</url-pattern>\\n    </filter-mapping>\\n    \\nDelegatingFilterProxy ���Զ��� Spring �����в�������Ϊ shiroFilter �� bean ���� filter ���󽻸�������\\n')])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"shiroe��ע��\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiroe��ע��\"}},[e._v(\"#\")]),e._v(\" ShiroȨ��ע��\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('Shiro�ṩ����Ӧ��ע������Ȩ�޿��ƣ����ʹ����Щע�����Ҫʹ��AOP�Ĺ����������жϣ�Shiro�ṩ��Spring AOP������\\n��Ȩ��ע��Ľ�������֤\\nΪ�˲��ԣ��˴�����Spring MVC������Shiroע�⣬��ȻShiroע�ⲻ��������web������ʹ�ã��ڶ�����JavaSE������Ҳ�ǿ�\\n��ʹ�õ�\\n\\n��spring-mvc.xml�����ļ�����Shiro Spring AOPȨ��ע���֧�֣�\\n    <aop:config proxy-target-class=\"true\"></aop:config>\\n    <bean class=\"\\n    org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor\">\\n        <property name=\"securityManager\" ref=\"securityManager\"/>\\n    </bean>\\n    \\n���žͿ�������Ӧ�Ŀ�������ʹ�����·�ʽ����ע�⣺\\n    @RequiresRoles(\"admin\")\\n    @RequestMapping(\"/hello\")\\n    public String hello() {\\n        return \"hello world\";\\n    }\\n')])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"e��ע��\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#e��ע��\"}},[e._v(\"#\")]),e._v(\" Ȩ��ע��\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"@RequiresAuthentication\\n    ��ʾ��ǰSubject�Ѿ�ͨ��login������������֤����Subject.isAuthenticated()����true\\n@RequiresUser\\n    ��ʾ��ǰSubject�Ѿ�������֤����ͨ����ס�ҵ�¼��\\n@RequiresGuest\\n    ��ʾ��ǰSubjectû��������֤��ͨ����ס�ҵ�¼�������ο�����\\n@RequiresRoles(value={��admin��, ��user��}, logical= Logical.AND)\\n    ��ʾ��ǰ��Subject��Ҫ��ɫadmin��user\\n@RequiresPermissions (value={��user:a��, ��user:b��}, logical= Logical.OR)\\n    ��ʾ��ǰSubject��ҪȨ��user:a��user:b\\n\")])]),e._v(\" \"),a(\"h2\",{attrs:{id:\"shiro-rememberme\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro-rememberme\"}},[e._v(\"#\")]),e._v(\" Shiro-RememberMe\")]),e._v(\" \"),a(\"h4\",{attrs:{id:\"rememberme\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#rememberme\"}},[e._v(\"#\")]),e._v(\" RememberMe\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v(\"Shiro�ṩ��RememberMe���ܣ������������£�\\n  1.�����ڵ�¼ҳ��ѡ��RememberMeȻ���¼�ɹ���������������¼��һ����RememberMe��Cookieд���ͻ���Ȼ��\\n    ��������\\n  2.�ر�����������´򿪣��ᷢ����������Ǽ�ס���\\n  3.�ܹ�����һ�����ҳ������ʾ�ѵ�¼\\n  4.����ĳЩ�ض�����ҳ���ܣ�������Ҫ�ٴν���������֤\\n\")])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"rememberme����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#rememberme����\"}},[e._v(\"#\")]),e._v(\" RememberMe����\")]),e._v(\" \"),a(\"h6\",{attrs:{id:\"web-xml����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#web-xml����\"}},[e._v(\"#\")]),e._v(\" web.xml����\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('  <bean id=\"sessionIdCookie\" class=\"org.apache.shiro.web.servlet.SimpleCookie\">\\n    <constructor-arg value=\"sid\"/>\\n      <property name=\"httpOnly\" value=\"true\"/>\\n      <property name=\"maxAge\" value=\"-1\"/>\\n  </bean>\\n  <bean id=\"rememberMeCookie\" class=\"org.apache.shiro.web.servlet.SimpleCookie\">\\n    <constructor-arg value=\"rememberMe\"/>\\n      <property name=\"httpOnly\" value=\"true\"/>\\n      <property name=\"maxAge\" value=\"2592000\"/>\\x3c!-- 30�� --\\x3e\\n  </bean>\\n')])]),e._v(\" \"),a(\"h6\",{attrs:{id:\"sessionidcookie��maxage-1����ʾ������ر�ʱʧч��cookie\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#sessionidcookie��maxage-1����ʾ������ر�ʱʧч��cookie\"}},[e._v(\"#\")]),e._v(\" sessionIdCookie��maxAge=-1����ʾ������ر�ʱʧЧ��Cookie\")]),e._v(\" \"),a(\"h6\",{attrs:{id:\"remembermecookie������ס�ҵ�cookie������ʱ��30��\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#remembermecookie������ס�ҵ�cookie������ʱ��30��\"}},[e._v(\"#\")]),e._v(\" rememberMeCookie������ס�ҵ�Cookie������ʱ��30��\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('  <bean id=\"rememberMeManager\" \\n    class=\"org.apache.shiro.web.mgt.CookieRememberMeManager\">\\n    <property name=\"cipherKey\" value=\"\\\\#{T(org.apache.shiro.codec.Base64).decode(\\'4AvVhmFLUs0KTA3Kprsdag==\\')}\"/>\\n    <property name=\"cookie\" ref=\"rememberMeCookie\"/>\\n  </bean>\\n')])]),e._v(\" \"),a(\"h6\",{attrs:{id:\"remembermemanager��rememberme��������cipherkey��rememberme-cookie����կ��i����aes�㷨\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#remembermemanager��rememberme��������cipherkey��rememberme-cookie����կ��i����aes�㷨\"}},[e._v(\"#\")]),e._v(\" rememberMeManager��RememberMe��������cipherKey��rememberMe Cookie����Կ��Ĭ����AES�㷨\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('  <bean id=\"securityManager\" class=\"org.apache.shiro.web.mgt.DefaultWebSecurityManager\">\\n    ����\\n    <property name=\"rememberMeManager\" ref=\"rememberMeManager\"/>\\n  </bean>\\n')])]),e._v(\" \"),a(\"h6\",{attrs:{id:\"��o������������securitymanager��o��������remembermemanager\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#��o������������securitymanager��o��������remembermemanager\"}},[e._v(\"#\")]),e._v(\" ��ȫ������������securityManager��ȫ��������rememberMeManager\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('  <bean id=\"formAuthenticationFilter\" \\n    class=\"org.apache.shiro.web.filter.authc.FormAuthenticationFilter\">\\n    ����\\n    <property name=\"rememberMeParam\" value=\"rememberMe\"/>\\n  </bean>\\n')])]),e._v(\" \"),a(\"h6\",{attrs:{id:\"remembermeparam����rememberme��������������������boolean���ͣ�true��ʾrememberme\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#remembermeparam����rememberme��������������������boolean���ͣ�true��ʾrememberme\"}},[e._v(\"#\")]),e._v(\" rememberMeParam����RememberMe��������������������boolean���ͣ�true��ʾRememberMe\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('  <bean id=\"shiroFilter\" class=\"org.apache.shiro.spring.web.ShiroFilterFactoryBean\">\\n    ����\\n    <property name=\"filterChainDefinitions\">\\n      <value>\\n        /login.jsp = authc\\n        /logout = logout\\n        /authenticated.jsp = authc\\n        /** = user\\n      </value>\\n    </property>\\n  </bean>\\n')])]),e._v(\" \"),a(\"h6\",{attrs:{id:\"��-authenticated-jsp-authc��-��ʾ���ʸo�ַ�u�����������֤ͨ����subject-isauthenticated-true������\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#��-authenticated-jsp-authc��-��ʾ���ʸo�ַ�u�����������֤ͨ����subject-isauthenticated-true������\"}},[e._v(\"#\")]),e._v(\" ��/authenticated.jsp = authc�� ��ʾ���ʸõ�ַ�û�����������֤ͨ����Subject. isAuthenticated()==true������\")]),e._v(\" \"),a(\"h6\",{attrs:{id:\"��-user��-��ʾ���ʸo�ַ���u���������֤ͨ����-rememberme-��¼�k�����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#��-user��-��ʾ���ʸo�ַ���u���������֤ͨ����-rememberme-��¼�k�����\"}},[e._v(\"#\")]),e._v(\" ��/** = user�� ��ʾ���ʸõ�ַ���û���������֤ͨ���� RememberMe ��¼�Ķ�����\")]),e._v(\" \"),a(\"h2\",{attrs:{id:\"shiro-������¼����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro-������¼����\"}},[e._v(\"#\")]),e._v(\" Shiro-������¼����\")]),e._v(\" \"),a(\"h4\",{attrs:{id:\"������¼�������a�spring-config-shiro-xml��\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#������¼�������a�spring-config-shiro-xml��\"}},[e._v(\"#\")]),e._v(\" ������¼�������ã�spring-config-shiro.xml��\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('<bean id=\"kickoutSessionControlFilter\" \\nclass=\"com.simon.web.shiro.filter.KickoutSessionControlFilter\">\\n    <property name=\"cacheManager\" ref=\"cacheManager\"/>\\n    <property name=\"sessionManager\" ref=\"sessionManager\"/>\\n    <property name=\"kickoutAfter\" value=\"false\"/>\\n    <property name=\"maxSession\" value=\"2\"/>\\n    <property name=\"kickoutUrl\" value=\"/login?kickout=1\"/>\\n</bean>\\n\\ncacheManager��ʹ��cacheManager��ȡ��Ӧ��cache�������û���¼�ĻỰ�����ڱ����û�-�Ự֮���ϵ��\\nsessionManager�����ڸ��ݻỰID����ȡ�Ự�����߳�����\\nkickoutAfter���Ƿ����������¼�ģ�Ĭ����false�������¼�û��߳�ǰ��¼�û�\\nmaxSession��ͬһ���û������Ự����Ĭ��1\\nkickoutUrl�����߳����ض��򵽵ĵ�ַ\\n')])]),e._v(\" \"),a(\"h4\",{attrs:{id:\"shiro-filter����\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#shiro-filter����\"}},[e._v(\"#\")]),e._v(\" Shiro-Filter����\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('<bean id=\"shiroFilter\" class=\"org.apache.shiro.spring.web.ShiroFilterFactoryBean\">\\n    <property name=\"securityManager\" ref=\"securityManager\"/>\\n    <property name=\"loginUrl\" value=\"/login\"/>\\n    <property name=\"filters\">\\n        <util:map>\\n            <entry key=\"authc\" value-ref=\"formAuthenticationFilter\"/>\\n            <entry key=\"sysUser\" value-ref=\"sysUserFilter\"/>\\n            <entry key=\"kickout\" value-ref=\"kickoutSessionControlFilter\"/>\\n        </util:map>\\n    </property>\\n    <property name=\"filterChainDefinitions\">\\n        <value>\\n            /login = authc\\n            /logout = logout\\n            /authenticated = authc\\n            /** = kickout,user,sysUser\\n        </value>\\n    </property>\\n</bean>\\n')])]),e._v(\" \"),a(\"h6\",{attrs:{id:\"kickoutsessioncontrolfilter���j���\"}},[a(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#kickoutsessioncontrolfilter���j���\"}},[e._v(\"#\")]),e._v(\" KickoutSessionControlFilter���Ĵ���\")]),e._v(\" \"),a(\"pre\",[a(\"code\",[e._v('protected boolean onAccessDenied(ServletRequest request, ServletResponse response) throws Exception {\\n    Subject subject = getSubject(request, response);\\n    if(!subject.isAuthenticated() && !subject.isRemembered()) {\\n        //���û�е�¼��ֱ�ӽ���֮�������\\n        return true;\\n    }\\n    Session session = subject.getSession();\\n    String username = (String) subject.getPrincipal();\\n    Serializable sessionId = session.getId();\\n    //TODO ͬ������\\n    Deque<Serializable> deque = cache.get(username);\\n    if(deque == null) {\\n        deque = new LinkedList<Serializable>();\\n        cache.put(username, deque);\\n    }\\n    //���������û�д�sessionId�����û�û�б��߳����������\\n    if(!deque.contains(sessionId) && session.getAttribute(\"kickout\") == null) {\\n        deque.push(sessionId);\\n    }\\n    //����������sessionId���������Ự������ʼ����\\n    while(deque.size() > maxSession) {\\n        Serializable kickoutSessionId = null;\\n        if(kickoutAfter) { //����߳�����\\n            kickoutSessionId = deque.removeFirst();\\n        } else { //�����߳�ǰ��\\n            kickoutSessionId = deque.removeLast();\\n        }\\n        try {\\n            Session kickoutSession =\\n                sessionManager.getSession(new DefaultSessionKey(kickoutSessionId));\\n            if(kickoutSession != null) {\\n                //���ûỰ��kickout���Ա�ʾ�߳���\\n                kickoutSession.setAttribute(\"kickout\", true);\\n            }\\n        } catch (Exception e) {//ignore exception\\n        }\\n    }\\n    //������߳��ˣ�ֱ���˳����ض����߳���ĵ�ַ\\n    if (session.getAttribute(\"kickout\") != null) {\\n        //�Ự���߳���\\n        try {\\n            subject.logout();\\n        } catch (Exception e) { //ignore\\n        }\\n        saveRequest(request);\\n        WebUtils.issueRedirect(request, response, kickoutUrl);\\n        return false;\\n    }\\n    return true;\\n}')])])])}),[],!1,null,null,null);r.default=s.exports}}]);","extractedComments":[]}