{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[65],{588:function(t,s,a){t.exports=a.p+\"assets/img/202001021327.d066e3ff.png\"},662:function(t,s,a){\"use strict\";a.r(s);var n=a(0),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":t.$parent.slotKey}},[n(\"blockquote\",[n(\"p\",[t._v(\"当一个Spring Boot项目运行时，开发者需要对Spring Boot项目进行实时监控，获取项目的运行情况，在项目出错时能够实现自动报警等。Spring Boot提供了actuator来帮助开发者获取应用程序的实时运行数据。开发者可以选择使用HTTP端点或JMX来管理和监控应用程序，获取应用程序的运行数据，包括健康状况、应用信息、内存使用情况等\")])]),t._v(\" \"),n(\"h3\",{attrs:{id:\"端点配置\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#端点配置\"}},[t._v(\"#\")]),t._v(\" 端点配置\")]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"开启端点\")]),n(\"br\"),t._v(\"\\n在Spring Boot中开启应用监控十分简单，只需导入spring-boot-starter-actuator相关依赖即可。开发者可以使用actuator中的端点对应用进行监控或者与应用交互，Spring Boot默认包含许多端点\")]),t._v(\" \"),n(\"p\",[t._v(\"Spring Boot默认包含的端点\")]),t._v(\" \"),n(\"table\",[n(\"thead\",[n(\"tr\",[n(\"th\",[t._v(\"端点\")]),t._v(\" \"),n(\"th\",[t._v(\"端点描述\")]),t._v(\" \"),n(\"th\",[t._v(\"是否开启\")])])]),t._v(\" \"),n(\"tbody\",[n(\"tr\",[n(\"td\",[t._v(\"autidevents\")]),t._v(\" \"),n(\"td\",[t._v(\"展示当前应用程序的审计事件信息\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"beans\")]),t._v(\" \"),n(\"td\",[t._v(\"展示所有Spring Bean的信息\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"conditions\")]),t._v(\" \"),n(\"td\",[t._v(\"展示一个自动配置类的使用报告，该报告展示所有自动配置类及它们被使用和未使用的原因\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"configprops\")]),t._v(\" \"),n(\"td\",[t._v(\"展示所有@ConfigurationProperties的列表\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"env\")]),t._v(\" \"),n(\"td\",[t._v(\"展示系统运行环境信息\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"flyway\")]),t._v(\" \"),n(\"td\",[t._v(\"展示数据库迁移路径\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"health\")]),t._v(\" \"),n(\"td\",[t._v(\"展示应用程序的健康信息\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"httptrace\")]),t._v(\" \"),n(\"td\",[t._v(\"展示trace信息（默认展示最新的100条http请求）\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"info\")]),t._v(\" \"),n(\"td\",[t._v(\"展示应用的定制信息，这些定制信息以info开头\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"loggers\")]),t._v(\" \"),n(\"td\",[t._v(\"展示并修改日志的应用配置\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"liquibase\")]),t._v(\" \"),n(\"td\",[t._v(\"展示任何Liquibase数据库迁移路径\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"metrics\")]),t._v(\" \"),n(\"td\",[t._v(\"展示应用程序度量信息\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"mappings\")]),t._v(\" \"),n(\"td\",[t._v(\"展示所有@RequestMapping路径的集合列表\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"scheduledtasks\")]),t._v(\" \"),n(\"td\",[t._v(\"展示应用的所有定时任务\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"shutdown\")]),t._v(\" \"),n(\"td\",[t._v(\"远程关闭应用接口\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"sessions\")]),t._v(\" \"),n(\"td\",[t._v(\"展示并操作Spring Session会话\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"threaddump\")]),t._v(\" \"),n(\"td\",[t._v(\"展示线程活动的快照\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])])])]),t._v(\" \"),n(\"p\",[t._v(\"Web应用包含另外的端点\")]),t._v(\" \"),n(\"table\",[n(\"thead\",[n(\"tr\",[n(\"th\",[t._v(\"端点\")]),t._v(\" \"),n(\"th\",[t._v(\"端点描述\")]),t._v(\" \"),n(\"th\",[t._v(\"是否开启\")])])]),t._v(\" \"),n(\"tbody\",[n(\"tr\",[n(\"td\",[t._v(\"headdump\")]),t._v(\" \"),n(\"td\",[t._v(\"返回一个Gzip压缩的hprof堆转储文件\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"jolokia\")]),t._v(\" \"),n(\"td\",[t._v(\"展示通过HTTP暴露的JMX beans\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"logfile\")]),t._v(\" \"),n(\"td\",[t._v(\"返回日志文件内容\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"prometheus\")]),t._v(\" \"),n(\"td\",[t._v(\"展示一个可以被prometheus服务器抓取的metrics数据\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])])])]),t._v(\" \"),n(\"p\",[t._v(\"这些端点大部分都是默认开启的，只有shutdown端点默认未开启，如果需要开启，可以在application.properties中通过如下配置开启：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"management.endpoint.shutdown.enabled=true\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\")])]),n(\"p\",[t._v(\"如果开发者不想暴露这么多端点，那么可以关闭默认的配置，然后手动指定需要开启哪些端点，如下配置表示关闭所有端点，只开启info端点：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"management.endpoints.enabled-by-default=false\\nmanagement.endpoint.info.enabled=true\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\")])]),n(\"p\",[n(\"strong\",[t._v(\"暴露端点\")]),n(\"br\"),t._v(\"\\n由于有的端点包含敏感信息，因此端点启用和端点暴露是两回事\")]),t._v(\" \"),n(\"p\",[t._v(\"端点的默认暴露情况\")]),t._v(\" \"),n(\"table\",[n(\"thead\",[n(\"tr\",[n(\"th\",[t._v(\"端点\")]),t._v(\" \"),n(\"th\",[t._v(\"端点描述\")]),t._v(\" \"),n(\"th\",[t._v(\"是否开启\")])])]),t._v(\" \"),n(\"tbody\",[n(\"tr\",[n(\"td\",[t._v(\"autidevents\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"beans\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"conditions\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"configprops\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"env\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"flyway\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"health\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"httptrace\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"info\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"loggers\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"liquibase\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"metrics\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"mappings\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"scheduledtasks\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"shutdown\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"sessions\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"threaddump\")]),t._v(\" \"),n(\"td\",[t._v(\"Yes\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"headdump\")]),t._v(\" \"),n(\"td\",[t._v(\"N/A\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"jolokia\")]),t._v(\" \"),n(\"td\",[t._v(\"N/A\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"logfile\")]),t._v(\" \"),n(\"td\",[t._v(\"N/A\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"prometheus\")]),t._v(\" \"),n(\"td\",[t._v(\"N/A\")]),t._v(\" \"),n(\"td\",[t._v(\"No\")])])])]),t._v(\" \"),n(\"p\",[t._v(\"在Web应用中，默认只有health和info两个端点暴露，开发者可以在配置文件中自定义需要暴露哪些端点\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"# 暴露mappings和metrics两个端点\\nmanagement.endpoints.web.exposure.include=mappings, metrics\\n\\n# 暴露所有端点\\nmanagement.endpoints.web.exposure.include=*\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),n(\"br\")])]),n(\"p\",[t._v(\"YAML配置文件中暴露所有端点\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v('management:\\n  endpoints:\\n    web:\\n      exposure:\\n        include: \"*\"\\n')])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),n(\"br\")])]),n(\"p\",[t._v(\"此时启动项目，并非所有的端点都在启动日志中展示出来，因为部分端点需要导入相关依赖才能启动，比如session端点需要导入Spring Session相关依赖。对于已经展示出来的端点，开发者可以直接访问接口 http://localhost:8080/actuator/端点名 来查看相关信息\")]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"端点保护\")]),n(\"br\"),t._v(\"\\n如果这些端点需要对外提供服务，那么最好将这些端点保护起来，若classpath中存在Spring Security，则默认使用Spring Security进行保护\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-java line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Configuration\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"class\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"ActuatorSecurity\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"extends\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"WebSecurityConfigurerAdapter\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Override\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"protected\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"void\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"configure\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"HttpSecurity\")]),t._v(\" http\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"throws\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Exception\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n        \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// 对于所有得端点都需要ADMIN用户才能访问，并添加httpBasic验证\")]),t._v(\"\\n        http\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"requestMatcher\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"EndpointRequest\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"toAnyEndpoint\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n                \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"authorizeRequests\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n                \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"anyRequest\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"hasRole\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"ADMIN\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n                \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"and\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\"\\n                \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"httpBasic\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"11\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"12\")]),n(\"br\")])]),n(\"p\",[n(\"strong\",[t._v(\"端点响应缓存\")]),n(\"br\"),t._v(\"\\n对于一些不带参数得端点请求会自动进行缓存，开发者可通过如下方式配置缓存时间\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"# 端点缓存时间为100S，如果要配置其它端点，将beans改为端点名称即可\\nmanagement.endpoint.beans.cache.time-to-live=100ms\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\")])]),n(\"div\",{staticClass:\"custom-block warning\"},[n(\"p\",[t._v(\"如果端点添加了Spring Security保护，此时Principal会被视为端点得输入，此时端点响应将不被缓存\")])]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"路径映射\")]),n(\"br\"),t._v('\\n默认情况下，所有的端点都暴露在\"/actuator\"路径下，开发者可以对端点路径进行定制')]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"# 将/actuator改为/\\nmanagement.endpoints.web.base-path=/\\n# 将health改为healthy\\nmanagement.endpoints.web.path-mapping.health=healthy\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),n(\"br\")])]),n(\"p\",[n(\"strong\",[t._v(\"CORS支持\")]),n(\"br\"),t._v(\"\\n所有端点都默认没有开启跨域，开发者通过如下配置快速开启CORS支持\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"# 允许端点处理来自http://localhost:8081的请求，允许的请求方法为GET或POST\\nmanagement.endpoints.web.cors.allowed-origins=http://localhost:8081\\nmanagement.endpoints.web.cors.allowed-methods=GET, POST\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\")])]),n(\"h3\",{attrs:{id:\"健康信息\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#健康信息\"}},[t._v(\"#\")]),t._v(\" 健康信息\")]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"展示健康信息详情\")]),n(\"br\"),t._v(\"\\n开发者可以通过查看健康信息来获取应用的运行数据，进而提早发现应用问题，提早解决，避免造成损失。默认情况下，开发者只能获取status信息，这是因为detail信息默认不显示，开发者可以通过management.health.show-detail属性来配置detail信息的显示策略，该属性的取值一共有3种：\")]),t._v(\" \"),n(\"ul\",[n(\"li\",[t._v(\"never：即不显示detail信息，默认即此\")]),t._v(\" \"),n(\"li\",[t._v(\"when-authorized：details信息只展示给认证用户，即用户登录后可以查看details信息，未登录则不能查看，另外还可以通过management.endpoint.health.roles属性配置要求的角色，如果不配置，那么任何用户角色登录后都可查看details信息，配置了则只有指定的用户角色登录后才可查看details信息\")]),t._v(\" \"),n(\"li\",[t._v(\"always：将details展示给所有用户\")])]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"健康指示器\")]),n(\"br\"),t._v(\"\\nSpring Boot会根据classpath中依赖的添加情况来自动添加一些HealthIndicators\")]),t._v(\" \"),n(\"table\",[n(\"thead\",[n(\"tr\",[n(\"th\",[t._v(\"名字\")]),t._v(\" \"),n(\"th\",[t._v(\"描述\")])])]),t._v(\" \"),n(\"tbody\",[n(\"tr\",[n(\"td\",[t._v(\"CassandraHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查Cassandra数据库状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"DiskSpaceHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"低磁盘空间检查\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"DataSourceHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查是否可以从DataSource获取一个Connection\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"ElasticsearchHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查Elasticsearch集群状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"InfluxDbHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查InfluxDb状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"JmsHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查Jms消息代理状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"MailHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查邮件服务器状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"MongoHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查MongoDB数据库状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"Neo4jHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查Neo4j服务器状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"RabbitHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查Rabbit服务器状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"RedisHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查Redis服务器状况\")])]),t._v(\" \"),n(\"tr\",[n(\"td\",[t._v(\"SolrHealthIndicator\")]),t._v(\" \"),n(\"td\",[t._v(\"检查Solr服务器状况\")])])])]),t._v(\" \"),n(\"p\",[t._v(\"如果项目中存在相关的依赖，那么列表中对应的HealthIndicator将会被自动配置，例如在pom.xml中添加了Redis依赖，此时访问health端点就将返回Redis的相关信息。若开发者不需要这么多的HealthIndicator，则可以通过如下配置关闭所有的HealthIndicator自动配置：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"management.health.defaults.enabled=false\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\")])]),n(\"p\",[n(\"strong\",[t._v(\"自定义HealthInfo\")]),n(\"br\"),t._v(\"\\n除了Spring Boot自动收集的这些HealthInfo信息之外，开发者也可以自定义HealthInfo，只需要实现HealthIndicator接口即可：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-java line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Component\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"class\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"MyHealthInfo\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"implements\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"HeadIndicator\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Override\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Health\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"health\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token comment\"}},[t._v(\"// checkNetwork是一个检查网络连接的方法，up和down分别对应UP和DOWN两种常见状态\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"checkNetwork\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Health\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"up\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"withDetail\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"message\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"网络连接正常\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"build\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Health\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"down\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"withDetail\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"message\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"网络连接异常\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"build\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"11\")]),n(\"br\")])]),n(\"div\",{staticClass:\"custom-block tip\"},[n(\"p\",[t._v(\"默认的响应状态一共有4种，定义在OrderedHealthAggregator，分别是DOWN、OUT_OF_SERVICE、UP、UNKNOWN，如果开发者想增加响应状态，可以自定义类继承自HealthAggregator，或者在application.properties种通过management.health.status.order属性进行配置\")])]),t._v(\" \"),n(\"p\",[t._v(\"如果开发者想要增加响应状态FATAL，在application.properties种增加如下配置：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"management.health.status.order=FATAL,DOWN,OUT_OF_SERVICE,UP,UNKNOWN\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\")])]),n(\"p\",[t._v(\"配置完成后，就可以在health方法中返回自定义的状态了\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-java line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Component\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"class\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"MyHealthInfo\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"implements\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"HeadIndicator\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Override\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Health\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"health\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"if\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"checkNetwork\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n      \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"return\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Health\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"status\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"FATAL\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"withDetail\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"message\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"网络连接正常\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"build\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"9\")]),n(\"br\")])]),n(\"p\",[t._v(\"此时虽然返回的status为FATAL，但是HTTP响应码为200，在默认的4种响应状态中，DOWN、OUT_OF_SERVICE的HTTP响应码为503，UP、UNKNOWN的HTTP响应码为200，如果开发者相对自定义的响应状态指定响应码，添加如下配置即可：\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"management.health.status.http-mapping.FATAL=503\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\")])]),n(\"h3\",{attrs:{id:\"应用信息\"}},[n(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#应用信息\"}},[t._v(\"#\")]),t._v(\" 应用信息\")]),t._v(\" \"),n(\"p\",[t._v(\"应用信息就是通过/actuator/info接口获取到的信息，主要包含三大类：自定义信息、Git信息以及项目构建信息\")]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"自定义信息\")]),t._v(\"\\n自定义信息既可以在配置文件中添加，也可以在java代码中添加，在配置文件中添加是指在application.properties中手动定义以info开头的信息\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"info.app.encoding=@project.build.sourceEncoding@\\ninfo.app.javaSource=@java.version@\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\")])]),n(\"div\",{staticClass:\"custom-block tip\"},[n(\"p\",[t._v(\"@...@表示引用maven中的定义\")])]),t._v(\" \"),n(\"p\",[t._v(\"在java代码中添加只需自定义类继承InfoContributor，然后实现该类中的contribute方法即可\")]),t._v(\" \"),n(\"div\",{staticClass:\"language-java line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-java\"}},[n(\"code\",[n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Component\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"class\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"MyInfo\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"implements\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"InfoContributor\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token annotation punctuation\"}},[t._v(\"@Override\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"public\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"void\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"contribute\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Info\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Builder\")]),t._v(\" builder\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"{\")]),t._v(\"\\n    \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"Map\")]),n(\"span\",{pre:!0,attrs:{class:\"token generics\"}},[n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"String\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"String\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),t._v(\" info \"),n(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[t._v(\"=\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token keyword\"}},[t._v(\"new\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token class-name\"}},[t._v(\"HashMap\")]),n(\"span\",{pre:!0,attrs:{class:\"token generics\"}},[n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"<\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\">\")])]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    info\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"put\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"encoding\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"UTF-8\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    info\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"put\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"javaSource\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" \"),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"1.8.0\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n    builder\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\".\")]),n(\"span\",{pre:!0,attrs:{class:\"token function\"}},[t._v(\"withDetail\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"(\")]),n(\"span\",{pre:!0,attrs:{class:\"token string\"}},[t._v('\"app\"')]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\",\")]),t._v(\" info\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\")\")]),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\";\")]),t._v(\"\\n  \"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\"),n(\"span\",{pre:!0,attrs:{class:\"token punctuation\"}},[t._v(\"}\")]),t._v(\"\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"10\")]),n(\"br\")])]),n(\"p\",[n(\"strong\",[t._v(\"Git信息\")]),n(\"br\"),t._v(\"\\nGit信息是指Git提交信息，当classpath下存在着一个git.properties文件时，Spring Boot会自动配置一个GitProperties Bean。开发者可通过Git插件自动生成Git提交信息，然后将这些展示在info端点中\")]),t._v(\" \"),n(\"p\",[t._v(\"Git提交完成后，在pom.xml中添加如下插件配置\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"<groupId>pl.project13.maven</groupId>\\n<artifactId>git-commit-id-plugin</artifactId>\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\")])]),n(\"p\",[t._v(\"使用该插件生成Git提交信息，插件添加成功后，在Maven Project中找到该插件，单击git-commit-id:revesion按钮，生成git提交信息\\n\"),n(\"img\",{attrs:{src:a(588),alt:\"\"}}),n(\"br\"),t._v(\"\\nGit提交信息生成成功之后，在当前项目的target/classes目录下会看到一个git.properties文件，打开就是Git的提交信息\")]),t._v(\" \"),n(\"div\",{staticClass:\"custom-block tip\"},[n(\"p\",[t._v(\"可以在配置文件中添加management.info.git.model=full/simple选择展示全部提交信息还是部分提交信息\")])]),t._v(\" \"),n(\"p\",[n(\"strong\",[t._v(\"项目构建信息\")]),n(\"br\"),t._v(\"\\n如果classpath下存在META-INF/build-info.properties文件，Spring Boot将自动构建BuildProperties Bean，然后info端点会发布文件中的信息\")]),t._v(\" \"),n(\"p\",[t._v(\"首先在pom.xml文件中添加插件\")]),t._v(\" \"),n(\"div\",{staticClass:\"language- line-numbers-mode\"},[n(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[n(\"code\",[t._v(\"<plugin>\\n  <groupId>org.springframework.boot</groupId>\\n  <artifactId>spring-boot-maven-plugin</artifactId>\\n  <executions>\\n    <execution>\\n      <goals>\\n        <goal>build-info</goal>\\n      </goals>\\n    </execution>\\n  </executions>\\n</plugin>\\n\")])]),t._v(\" \"),n(\"div\",{staticClass:\"line-numbers-wrapper\"},[n(\"span\",{staticClass:\"line-number\"},[t._v(\"1\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"2\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"3\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"4\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"5\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"6\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"7\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"8\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"9\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"10\")]),n(\"br\"),n(\"span\",{staticClass:\"line-number\"},[t._v(\"11\")]),n(\"br\")])]),n(\"p\",[t._v(\"插件添加成功后，在Maven Project中找到该插件，单击spring-boot:build-info按钮，生成构建信息。项目构建信息生成成功后，在当前项目目录的target/classes/META-INF下会生成一个build-info.properties文件，此时访问项目的info端点，构建信息将被自动发布\")])])}),[],!1,null,null,null);s.default=e.exports}}]);","extractedComments":[]}